/*!
 * elmah.io Javascript Logger - version 3.0.0-beta2
 * (c) 2018 elmah.io, Apache 2.0 License, https://elmah.io
 */
!function(e,t){"function"==typeof define&&define.amd?define([],function(){return t(e)}):"object"==typeof exports?module.exports=t(e):e.Elmahio=t(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,function(e){"use strict";var t=document.getElementsByTagName("script"),n=function(e){var t=new Object;if(!e)return t;for(var n=e.split(/[;&]/),r=0;r<n.length;r++){var o=n[r].split("=");if(o&&2===o.length){var i=unescape(o[0]),a=unescape(o[1]);a=a.replace(/\+/g," "),t[i]=a}}return t}(t[t.length-1].src.replace(/^[^\?]+\??/,"")),r=function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(n),o={label:" elmah.io debugger : On ",labelCSS:"background: #06a89c; color: #ffffff; display: inline-block; font-size: 14px;",successCSS:"background: #d4edda; color: #155724; display: inline-block; font-size: 13px;",errorCSS:"background: #f8d7da; color: #721c24; display: inline-block; font-size: 13px;",warningCSS:"background: #fff3cd; color: #856404; display: inline-block; font-size: 13px;",lightCSS:"background: #e2e3e5; color: #383d41; display: inline-block; font-size: 13px;"},i={apiKey:null,logId:null,debug:!1,application:null,filter:null},a=function(){var e={},t=!1,n=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],n++);for(var r=function(n){for(var r in n)n.hasOwnProperty(r)&&(t&&"[object Object]"===Object.prototype.toString.call(n[r])?e[r]=a(e[r],n[r]):e[r]=n[r])};n<arguments.length;n++){r(arguments[n])}return e};function l(){var t=e.location.search.substr(1);return null!==t&&""!==t?function(e){for(var t=[],n=e.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");t.push({key:o[0],value:o[1]})}return t}(t):{}}function s(e,t){var n={};for(var r in e)n[r]=e[r];for(var o in t)n[o]=t[o];return n}function c(e){var t=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,r=/^(eval@)?(\[native code\])?$/;return{parse:function(t){return void 0!==t.stacktrace||void 0!==t["opera#sourceloc"]?this.parseOpera(t):t.stack&&t.stack.match(n)?this.parseV8OrIE(t):t.stack?this.parseFFOrSafari(t):e.debug?void console.log("%c Cannot parse given Error object",o.warningCSS):null},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(n)},this).map(function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),n=this.extractLocation(t.pop());return{functionName:t.join(" ")||void 0,fileName:["eval","<anonymous>"].indexOf(n[0])>-1?void 0:n[0],lineNumber:n[1],columnNumber:n[2],source:e}},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(r)},this).map(function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return{functionName:e};var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),r=n&&n[1]?n[1]:void 0,o=this.extractLocation(e.replace(t,""));return{functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:e}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[],o=2,i=n.length;o<i;o+=2){var a=t.exec(n[o]);a&&r.push({fileName:a[2],lineNumber:a[1],source:n[o]})}return r},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o+=2){var a=t.exec(n[o]);a&&r.push({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:n[o]})}return r},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(e){var t,n=e.split("@"),r=this.extractLocation(n.pop()),o=n.shift()||"",i=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;return o.match(/\(([^\)]*)\)/)&&(t=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1")),{functionName:i,args:void 0===t||"[arguments not available]"===t?void 0:t.split(","),fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e}},this)}}}var u=function(t){var u,p={};function d(){var t={url:document.location.pathname||"/",application:u.application},n=[];navigator.language&&n.push({key:"User-Language",value:navigator.language}),document.documentMode&&n.push({key:"Document-Mode",value:document.documentMode}),(e.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth)&&n.push({key:"Browser-Width",value:e.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth}),(e.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight)&&n.push({key:"Browser-Height",value:e.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight}),void 0!==(screen.msOrientation||(screen.orientation||screen.mozOrientation||{}).type)&&n.push({key:"Screen-Orientation",value:(screen.msOrientation||(screen.orientation||screen.mozOrientation||{}).type).split("-")[0]}),screen.width&&n.push({key:"Screen-Width",value:screen.width}),screen.height&&n.push({key:"Screen-Height",value:screen.height}),screen.colorDepth&&n.push({key:"Color-Depth",value:screen.colorDepth}),n.push({key:"X-ELMAHIO-SEARCH-isClientside",value:"true"}),t.data=n;var r=[];return navigator.userAgent&&r.push({key:"User-Agent",value:navigator.userAgent}),document.referrer&&r.push({key:"Referer",value:document.referrer}),"https:"===document.location.protocol&&r.push({key:"HTTPS",value:"on"}),document.location.hostname&&r.push({key:"Host",value:document.location.hostname}),t.serverVariables=r,t}function f(e,t){u.debug&&("error"===e?console.log("%c ⯈ Error log: %c ✕ Not created ",o.lightCSS,o.errorCSS):"success"===e?console.log("%c ⯈ Error log: %c ✔ "+t+" at "+(new Date).toLocaleString()+" ",o.lightCSS,o.successCSS):console.log("%c ⯈ Error log: %c ✕ Not created. Title should not be undefined, null or empty ! ",o.lightCSS,o.errorCSS))}var g=function(e,t,o,i,a,f){var g=e,m=t,h=i,v=f,y=a,b=1,S=l();if((null===g||null===m)&&2!==r)return console.log("Login api error");n.hasOwnProperty("apiKey")&&n.hasOwnProperty("logId")&&(g=n.apiKey,m=n.logId);var O=new XMLHttpRequest;if(O.open("POST","https://api.elmah.io/v3/messages/"+m+"?api_key="+g,!0),O.setRequestHeader("Content-type","application/json"),O.onload=function(e){4===O.readyState&&201===O.status&&o("success",O.statusText)},O.onerror=function(e){o("error",O.statusText),p.emit("error",O.status,O.statusText)},"Log"!==h){var k=v?c(u).parse(v):null,N={title:y,source:k&&k.length>0?k[0].fileName:null,detail:v?v.stack:null,severity:h,type:v?v.name:null,queryString:JSON.parse(JSON.stringify(S))};N=s(N,d())}else N=v;null!==u.filter&&u.filter(N)&&(b=0),1===b&&(N.title?(p.emit("message",N),O.send(JSON.stringify(N))):o("missing-title",O.statusText))};return p.error=function(e){g(u.apiKey,u.logId,f,"Error",e)},p.error=function(e,t){g(u.apiKey,u.logId,f,"Error",e,t)},p.verbose=function(e){g(u.apiKey,u.logId,f,"Verbose",e)},p.verbose=function(e,t){g(u.apiKey,u.logId,f,"Verbose",e,t)},p.debug=function(e){g(u.apiKey,u.logId,f,"Debug",e)},p.debug=function(e,t){g(u.apiKey,u.logId,f,"Debug",e,t)},p.information=function(e){g(u.apiKey,u.logId,f,"Information",e)},p.information=function(e,t){g(u.apiKey,u.logId,f,"Information",e,t)},p.warning=function(e){g(u.apiKey,u.logId,f,"Warning",e)},p.warning=function(e,t){g(u.apiKey,u.logId,f,"Warning",e,t)},p.fatal=function(e){g(u.apiKey,u.logId,f,"Fatal",e)},p.fatal=function(e,t){g(u.apiKey,u.logId,f,"Fatal",e,t)},p.log=function(e){g(u.apiKey,u.logId,f,"Log",null,e)},p.on=function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},p.emit=function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},p.init=function(t){u=a(i,t||{}),e.onerror=function(e,t,o,i,a){var g={message:e,source:t,lineno:o,colno:i,error:a};return function(e,t,o,i){var a=e,f=t,g=i,m=1,h=l();if((null===a||null===f)&&2!==r)return console.log("Login api error");n.hasOwnProperty("apiKey")&&n.hasOwnProperty("logId")&&(a=n.apiKey,f=n.logId);var v=new XMLHttpRequest;v.open("POST","https://api.elmah.io/v3/messages/"+f+"?api_key="+a,!0),v.setRequestHeader("Content-type","application/json"),v.onload=function(e){4===v.readyState&&201===v.status&&o("success",v.statusText)},v.onerror=function(e){o("error",v.statusText),p.emit("error",v.status,v.statusText)};var y=c(u).parse(g.error),b={detail:g.error.stack,title:g.message||"Unspecified error",source:y&&y.length>0?y[0].fileName:null,severity:"Error",type:g.error.name,queryString:JSON.parse(JSON.stringify(h))};b=s(b,d()),null!==u.filter&&u.filter(b)&&(m=0),1===m&&(p.emit("message",b),v.send(JSON.stringify(b)))}(u.apiKey,u.logId,f,g),!1}},p.init(t),u.debug&&console.log("%c"+o.label,o.labelCSS),p};return r&&n.hasOwnProperty("apiKey")&&n.hasOwnProperty("logId")?new u:u});
//# sourceMappingURL=elmahio.min.js.map
